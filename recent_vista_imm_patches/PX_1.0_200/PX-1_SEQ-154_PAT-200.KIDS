Released PX*1*200 SEQ #154
Extracted from mail message
**KIDS**:PX*1.0*200^

**INSTALL NAME**
PX*1.0*200
"BLD",9117,0)
PX*1.0*200^PCE PATIENT CARE ENCOUNTER^0^3140424^y
"BLD",9117,1,0)
^^1^1^3140224^
"BLD",9117,1,1,0)
See patch description.
"BLD",9117,4,0)
^9.64PA^^
"BLD",9117,6)
4^
"BLD",9117,6.3)
14
"BLD",9117,"ABPKG")
n
"BLD",9117,"KRN",0)
^9.67PA^779.2^20
"BLD",9117,"KRN",.4,0)
.4
"BLD",9117,"KRN",.401,0)
.401
"BLD",9117,"KRN",.402,0)
.402
"BLD",9117,"KRN",.403,0)
.403
"BLD",9117,"KRN",.5,0)
.5
"BLD",9117,"KRN",.84,0)
.84
"BLD",9117,"KRN",3.6,0)
3.6
"BLD",9117,"KRN",3.8,0)
3.8
"BLD",9117,"KRN",9.2,0)
9.2
"BLD",9117,"KRN",9.8,0)
9.8
"BLD",9117,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9117,"KRN",9.8,"NM",1,0)
PXRPC^^0^B39810837
"BLD",9117,"KRN",9.8,"NM","B","PXRPC",1)

"BLD",9117,"KRN",19,0)
19
"BLD",9117,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",9117,"KRN",19,"NM",1,0)
NHIN APPLICATION PROXY^^0
"BLD",9117,"KRN",19,"NM","B","NHIN APPLICATION PROXY",1)

"BLD",9117,"KRN",19.1,0)
19.1
"BLD",9117,"KRN",101,0)
101
"BLD",9117,"KRN",409.61,0)
409.61
"BLD",9117,"KRN",771,0)
771
"BLD",9117,"KRN",779.2,0)
779.2
"BLD",9117,"KRN",870,0)
870
"BLD",9117,"KRN",8989.51,0)
8989.51
"BLD",9117,"KRN",8989.52,0)
8989.52
"BLD",9117,"KRN",8994,0)
8994
"BLD",9117,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",9117,"KRN",8994,"NM",1,0)
PX SAVE DATA^^0
"BLD",9117,"KRN",8994,"NM","B","PX SAVE DATA",1)

"BLD",9117,"KRN","B",.4,.4)

"BLD",9117,"KRN","B",.401,.401)

"BLD",9117,"KRN","B",.402,.402)

"BLD",9117,"KRN","B",.403,.403)

"BLD",9117,"KRN","B",.5,.5)

"BLD",9117,"KRN","B",.84,.84)

"BLD",9117,"KRN","B",3.6,3.6)

"BLD",9117,"KRN","B",3.8,3.8)

"BLD",9117,"KRN","B",9.2,9.2)

"BLD",9117,"KRN","B",9.8,9.8)

"BLD",9117,"KRN","B",19,19)

"BLD",9117,"KRN","B",19.1,19.1)

"BLD",9117,"KRN","B",101,101)

"BLD",9117,"KRN","B",409.61,409.61)

"BLD",9117,"KRN","B",771,771)

"BLD",9117,"KRN","B",779.2,779.2)

"BLD",9117,"KRN","B",870,870)

"BLD",9117,"KRN","B",8989.51,8989.51)

"BLD",9117,"KRN","B",8989.52,8989.52)

"BLD",9117,"KRN","B",8994,8994)

"BLD",9117,"QUES",0)
^9.62^^
"BLD",9117,"REQB",0)
^9.611^^
"KRN",19,2921312,-1)
0^1
"KRN",19,2921312,0)
NHIN APPLICATION PROXY^Nhin Application Proxy^^B^^^^^^^^
"KRN",19,2921312,1,0)
^19.06^3^3^3140423^^^^
"KRN",19,2921312,1,1,0)
This option allows the NHIN connector proxy access to the VistA system.
"KRN",19,2921312,1,2,0)

"KRN",19,2921312,1,3,0)

"KRN",19,2921312,99.1)
62045,58392
"KRN",19,2921312,"RPC",0)
^19.05P^4^2
"KRN",19,2921312,"RPC",3,0)
PX SAVE DATA
"KRN",19,2921312,"RPC",4,0)
VPR GET PATIENT DATA
"KRN",19,2921312,"U")
NHIN APPLICATION PROXY
"KRN",8994,3613,-1)
0^1
"KRN",8994,3613,0)
PX SAVE DATA^SAVE^PXRPC^1^P^^^^^^1
"KRN",8994,3613,1,0)
^^3^3^3140423^
"KRN",8994,3613,1,1,0)
The purpose of this RPC is to allow the calling application to save data 
"KRN",8994,3613,1,2,0)
to PCE, such as Immunization data. See the Integration Control 
"KRN",8994,3613,1,3,0)
Registration document for the full description of the data needed.
"KRN",8994,3613,2,0)
^8994.02A^4^4
"KRN",8994,3613,2,1,0)
PCELIST^2^10000^1^1
"KRN",8994,3613,2,1,1,0)
^8994.021^46^46^3140423^^
"KRN",8994,3613,2,1,1,1,0)
PCELIST (n)= HDR ^ Encounter Inpatient? ^ Note has CPT codes? ^ Visit 
"KRN",8994,3613,2,1,1,2,0)
             string [Encounter location; Encounter date/time; Encounter
"KRN",8994,3613,2,1,1,3,0)
             Service category]  (REQUIRED)
"KRN",8994,3613,2,1,1,4,0)
        (n)=VST^DT^Encounter date/time
"KRN",8994,3613,2,1,1,5,0)
        (n)=VST^PT^Encounter patient (DFN) (n)=VST^HL^Encounter location
"KRN",8994,3613,2,1,1,6,0)
        (n)=VST^VC^ Encounter Service Category
"KRN",8994,3613,2,1,1,7,0)
 
"KRN",8994,3613,2,1,1,8,0)
        If  applicable:
"KRN",8994,3613,2,1,1,9,0)
              
"KRN",8994,3613,2,1,1,10,0)
        (n)=VST^PR^ Parent for secondary visit
"KRN",8994,3613,2,1,1,11,0)
        (n)=VST^OL^ Outside Location for Historical visits
"KRN",8994,3613,2,1,1,12,0)
        (n)=VST^SC^ Service Connected related?
"KRN",8994,3613,2,1,1,13,0)
        (n)=VST^AO^ Agent Orange related?
"KRN",8994,3613,2,1,1,14,0)
        (n)=VST^IR^ Ionizing Radiation related?
"KRN",8994,3613,2,1,1,15,0)
        (n)=VST^EC^ Environmental Contaminates related?
"KRN",8994,3613,2,1,1,16,0)
        (n)=VST^MST^ Military Sexual Trauma related?
"KRN",8994,3613,2,1,1,17,0)
        (n)=VST^HNC^ Head and/or Neck Cancer related?
"KRN",8994,3613,2,1,1,18,0)
        (n)=VST^CV^ Combat Vet related?
"KRN",8994,3613,2,1,1,19,0)
        (n)=VST^SHD^ Shipboard Hazard and Defense related?
"KRN",8994,3613,2,1,1,20,0)
 
"KRN",8994,3613,2,1,1,21,0)
        (n)=PRV^PRV ^ Provider IEN ^^^ Provider Name ^ Primary Provider?
"KRN",8994,3613,2,1,1,22,0)
        (n)=POV(+:  add, -: delete) ^ ICD diagnosis code ^ Category  ^ 
"KRN",8994,3613,2,1,1,23,0)
            Narrative (Diagnosis description) ^ Primary Diagnosis? ^
"KRN",8994,3613,2,1,1,24,0)
            Provider String ^ Add to Problem List? ^^^ Next comment
"KRN",8994,3613,2,1,1,25,0)
            sequence # if saving comments
"KRN",8994,3613,2,1,1,26,0)
        (n)=COM^COM (Comments) ^ Next comment sequence # ^ @ = no 
"KRN",8994,3613,2,1,1,27,0)
            comments added
"KRN",8994,3613,2,1,1,28,0)
        (n)=CPT (+:  add, -: delete) ^ Procedural  CPT code ^ Category ^ 
"KRN",8994,3613,2,1,1,29,0)
            Narrative (Procedure description) ^ Quantity ^ Provider IEN
"KRN",8994,3613,2,1,1,30,0)
            ^^^ [# of modifiers;  Modifier code/Modifier IEN ^ Next
"KRN",8994,3613,2,1,1,31,0)
            comment sequence # ^
"KRN",8994,3613,2,1,1,32,0)
        (n)= IMM (+:  add, -: delete) ^ Immunization IEN ^ Category ^ 
"KRN",8994,3613,2,1,1,33,0)
             Narrative (Immunization description/name) ^ Series ^^
"KRN",8994,3613,2,1,1,34,0)
             Reaction ^ Contraindicated? ^^ Next comment sequence #
"KRN",8994,3613,2,1,1,35,0)
        (n)=SK (+:  add, -: delete) ^ Skin Test IEN ^ Category ^ 
"KRN",8994,3613,2,1,1,36,0)
            Narrative (Skin Test description/name) ^ Results ^^ Reading
"KRN",8994,3613,2,1,1,37,0)
            ^^^ Next comment sequence #
"KRN",8994,3613,2,1,1,38,0)
        (n)=PED (+:  add, -: delete) ^ Patient Education IEN ^ Category ^ 
"KRN",8994,3613,2,1,1,39,0)
            Narrative (Patient Education description/name) ^ Level of
"KRN",8994,3613,2,1,1,40,0)
            understanding ^^^^^ ^^ Next comment sequence #
"KRN",8994,3613,2,1,1,41,0)
        (n)=HF (+:  add, -: delete) ^ Health Factor IEN ^ Category ^ 
"KRN",8994,3613,2,1,1,42,0)
            Narrative (Health Factor description/name) ^ Level ^^^^^ Next
"KRN",8994,3613,2,1,1,43,0)
            comment sequence # ^ Get Reminder
"KRN",8994,3613,2,1,1,44,0)
        (n)=XAM(+:  add, -: delete) ^ Exam IEN ^ Category ^ Narrative 
"KRN",8994,3613,2,1,1,45,0)
            (Exam description/name) ^ Results ^^^^^ Next comment sequence
"KRN",8994,3613,2,1,1,46,0)
            #
"KRN",8994,3613,2,2,0)
LOC^1^40^0^2
"KRN",8994,3613,2,2,1,0)
^^2^2^3140225^
"KRN",8994,3613,2,2,1,1,0)
This is the hospital location. This is not used when the information is 
"KRN",8994,3613,2,2,1,2,0)
from an outside source.
"KRN",8994,3613,2,3,0)
PKGNAME^1^60^1^3
"KRN",8994,3613,2,3,1,0)
^^2^2^3140225^
"KRN",8994,3613,2,3,1,1,0)
The package name that is sending the data to PCE. This should be the 
"KRN",8994,3613,2,3,1,2,0)
full package name, such as PATIENT CARE ENCOUNTERS. 
"KRN",8994,3613,2,4,0)
SRC^1^60^1^4
"KRN",8994,3613,2,4,1,0)
^^1^1^3140225^
"KRN",8994,3613,2,4,1,1,0)
The source of the data - such as VLER E-HEALTH EXCHANGE.
"KRN",8994,3613,2,"B","LOC",2)

"KRN",8994,3613,2,"B","PCELIST",1)

"KRN",8994,3613,2,"B","PKGNAME",3)

"KRN",8994,3613,2,"B","SRC",4)

"KRN",8994,3613,2,"PARAMSEQ",1,1)

"KRN",8994,3613,2,"PARAMSEQ",2,2)

"KRN",8994,3613,2,"PARAMSEQ",3,3)

"KRN",8994,3613,2,"PARAMSEQ",4,4)

"KRN",8994,3613,3,0)
^^8^8^3140313^
"KRN",8994,3613,3,1,0)
The only return will be the one passed back to the calling application.
"KRN",8994,3613,3,2,0)
 
"KRN",8994,3613,3,3,0)
A -2 indicates that the routine PXAI found an issue even though the 
"KRN",8994,3613,3,4,0)
original input values appeared to be correct.
"KRN",8994,3613,3,5,0)
 
"KRN",8994,3613,3,6,0)
A -3 indicates that the input parameters were not properly defined.
"KRN",8994,3613,3,7,0)
 
"KRN",8994,3613,3,8,0)
A 1 indicate success.
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",567,-1)
1^1
"PKG",567,0)
PCE PATIENT CARE ENCOUNTER^PX^Patient Care Encounter
"PKG",567,22,0)
^9.49I^1^1
"PKG",567,22,1,0)
1.0^2960812^2960827^1
"PKG",567,22,1,"PAH",1,0)
200^3140424^520736418
"PKG",567,22,1,"PAH",1,1,0)
^^1^1^3140424
"PKG",567,22,1,"PAH",1,1,1,0)
See patch description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PXRPC")
0^1^B39810837^n/a
"RTN","PXRPC",1,0)
PXRPC ;ISL/JLC - PCE DATA2PCE RPC;01/28/2014 12:52 ; 17 Apr 2014  9:00 AM
"RTN","PXRPC",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**200**;Aug 12, 1996;Build 14
"RTN","PXRPC",3,0)
 ;
"RTN","PXRPC",4,0)
 ;
"RTN","PXRPC",5,0)
 ;
"RTN","PXRPC",6,0)
SAVE(OK,PCELIST,LOC,PKGNAME,SRC) ; save PCE information
"RTN","PXRPC",7,0)
 N VSTR
"RTN","PXRPC",8,0)
 I '$D(PCELIST(1)) S OK=-3 Q
"RTN","PXRPC",9,0)
 S VSTR=$P(PCELIST(1),U,4) K ^TMP("PXRPC",$J,VSTR)
"RTN","PXRPC",10,0)
 I $G(PKGNAME)="" S OK=-3 Q
"RTN","PXRPC",11,0)
 I $G(SRC)="" S OK=-3 Q
"RTN","PXRPC",12,0)
 M ^TMP("PXRPC",$J,VSTR)=PCELIST
"RTN","PXRPC",13,0)
DQSAVE ; 
"RTN","PXRPC",14,0)
 N PKG,TYP,CODE,IEN,I,X,PXAPI,PXDEL,ERROR
"RTN","PXRPC",15,0)
 N CAT,NARR,ROOT,ROOT2,PXAVST,LEXIEN
"RTN","PXRPC",16,0)
 N PRV,CPT,ICD,IMM,SK,PED,HF,XAM,TRT,MOD,MODCNT,MODIDX,MODS
"RTN","PXRPC",17,0)
 N COM,COMMENT,COMMENTS
"RTN","PXRPC",18,0)
 N DFN,PROBLEMS,PXAPREDT,ORCPTDEL
"RTN","PXRPC",19,0)
 S PKG=$$PKG2IEN^VSIT(PKGNAME) I PKG=-1 S OK=-3 Q
"RTN","PXRPC",20,0)
 S (PRV,CPT,ICD,IMM,SK,PED,HF,XAM,TRT)=0
"RTN","PXRPC",21,0)
 S I="" F  S I=$O(PCELIST(I)) Q:'I  S X=PCELIST(I) D
"RTN","PXRPC",22,0)
 . S X=PCELIST(I),TYP=$P(X,U),CODE=$P(X,U,2),CAT=$P(X,U,3),NARR=$P(X,U,4)
"RTN","PXRPC",23,0)
 . I $E(TYP,1,3)="PRV" D  Q
"RTN","PXRPC",24,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",25,0)
 . . S PRV=PRV+1
"RTN","PXRPC",26,0)
 . . S ROOT="PXAPI(""PROVIDER"","_PRV_")"
"RTN","PXRPC",27,0)
 . . S ROOT2="PXDEL(""PROVIDER"","_PRV_")"
"RTN","PXRPC",28,0)
 . . I $E(TYP,4)'="-" D
"RTN","PXRPC",29,0)
 . . . S @ROOT@("NAME")=CODE
"RTN","PXRPC",30,0)
 . . . S @ROOT@("PRIMARY")=$P(X,U,6)
"RTN","PXRPC",31,0)
 . . S @ROOT2@("NAME")=CODE
"RTN","PXRPC",32,0)
 . . S @ROOT2@("DELETE")=1
"RTN","PXRPC",33,0)
 . . S PXAPREDT=1 ;Allow edit of primary flag
"RTN","PXRPC",34,0)
 . I TYP="VST" D  Q
"RTN","PXRPC",35,0)
 . . S ROOT="PXAPI(""ENCOUNTER"",1)"
"RTN","PXRPC",36,0)
 . . I CODE="DT" S @ROOT@("ENC D/T")=$P(X,U,3) Q
"RTN","PXRPC",37,0)
 . . I CODE="PT" S @ROOT@("PATIENT")=$P(X,U,3),DFN=$P(X,U,3) Q
"RTN","PXRPC",38,0)
 . . I CODE="HL" S @ROOT@("HOS LOC")=$P(X,U,3) Q
"RTN","PXRPC",39,0)
 . . I CODE="PR" S @ROOT@("PARENT")=$P(X,U,3) Q
"RTN","PXRPC",40,0)
 . . ;prevents checkout!
"RTN","PXRPC",41,0)
 . . I CODE="VC" S @ROOT@("SERVICE CATEGORY")=$P(X,U,3) Q
"RTN","PXRPC",42,0)
 . . I CODE="SC" S @ROOT@("SC")=$P(X,U,3) Q
"RTN","PXRPC",43,0)
 . . I CODE="AO" S @ROOT@("AO")=$P(X,U,3) Q
"RTN","PXRPC",44,0)
 . . I CODE="IR" S @ROOT@("IR")=$P(X,U,3) Q
"RTN","PXRPC",45,0)
 . . I CODE="EC" S @ROOT@("EC")=$P(X,U,3) Q
"RTN","PXRPC",46,0)
 . . I CODE="MST" S @ROOT@("MST")=$P(X,U,3) Q
"RTN","PXRPC",47,0)
 . . I CODE="HNC" S @ROOT@("HNC")=$P(X,U,3) Q
"RTN","PXRPC",48,0)
 . . I CODE="CV" S @ROOT@("CV")=$P(X,U,3) Q
"RTN","PXRPC",49,0)
 . . I CODE="SHD" S @ROOT@("SHAD")=$P(X,U,3) Q
"RTN","PXRPC",50,0)
 . . I CODE="OL" D  Q
"RTN","PXRPC",51,0)
 . . . I +$P(X,U,3) S @ROOT@("INSTITUTION")=$P(X,U,3)
"RTN","PXRPC",52,0)
 . . . E  I $P(X,U,4)'="",$P(X,U,4)'="0" D
"RTN","PXRPC",53,0)
 . . . . I $$PATCH^XPDUTL("PX*1.0*96") S @ROOT@("OUTSIDE LOCATION")=$P(X,U,4)
"RTN","PXRPC",54,0)
 . . . . E  S @ROOT@("COMMENT")="OUTSIDE LOCATION:  "_$P(X,U,4)
"RTN","PXRPC",55,0)
 . I $E(TYP,1,3)="CPT" D  Q
"RTN","PXRPC",56,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",57,0)
 . . S CPT=CPT+1,ROOT="PXAPI(""PROCEDURE"","_CPT_")"
"RTN","PXRPC",58,0)
 . . S IEN=$$CODEN^ICPTCOD(CODE) ;ICR #1995
"RTN","PXRPC",59,0)
 . . S @ROOT@("PROCEDURE")=IEN
"RTN","PXRPC",60,0)
 . . I +$P(X,U,9) D
"RTN","PXRPC",61,0)
 . . . S MODS=$P(X,U,9),MODCNT=+MODS
"RTN","PXRPC",62,0)
 . . . F MODIDX=1:1:MODCNT D
"RTN","PXRPC",63,0)
 . . . . S MOD=$P($P(MODS,";",MODIDX+1),"/")
"RTN","PXRPC",64,0)
 . . . . S @ROOT@("MODIFIERS",MOD)=""
"RTN","PXRPC",65,0)
 . . S:$L(CAT) @ROOT@("CATEGORY")=CAT
"RTN","PXRPC",66,0)
 . . S:$L(NARR) @ROOT@("NARRATIVE")=NARR
"RTN","PXRPC",67,0)
 . . S:$L($P(X,U,5)) @ROOT@("QTY")=$P(X,U,5)
"RTN","PXRPC",68,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",69,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="PROCEDURE^"_CPT
"RTN","PXRPC",70,0)
 . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1,@ROOT@("QTY")=0,ORCPTDEL=CPT
"RTN","PXRPC",71,0)
 . I $E(TYP,1,3)="POV" D  Q
"RTN","PXRPC",72,0)
 . . N PXDXI,PXDX
"RTN","PXRPC",73,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",74,0)
 . . F PXDXI=1:1:$L(CODE,"/") D
"RTN","PXRPC",75,0)
 . . . S PXDX=$P(CODE,"/",PXDXI)
"RTN","PXRPC",76,0)
 . . . S ICD=ICD+1,ROOT="PXAPI(""DX/PL"","_ICD_")"
"RTN","PXRPC",77,0)
 . . . S IEN=+$$CODEN^ICDCODE(PXDX,80) ;ICR #3990
"RTN","PXRPC",78,0)
 . . . S @ROOT@("DIAGNOSIS")=IEN
"RTN","PXRPC",79,0)
 . . . S @ROOT@("PRIMARY")=$S(PXDXI=1:$P(X,U,5),1:0)
"RTN","PXRPC",80,0)
 . . . S LEXIEN=$P($$EXP^LEXCODE(CODE,"ICD",DT),U),@ROOT@("LEXICON TERM")=$S(LEXIEN>0:LEXIEN,1:"")
"RTN","PXRPC",81,0)
 . . . S:$L(CAT) @ROOT@("CATEGORY")=CAT
"RTN","PXRPC",82,0)
 . . . S:$L(NARR) @ROOT@("NARRATIVE")=NARR
"RTN","PXRPC",83,0)
 . . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",84,0)
 . . . I $L($P(X,U,7)),($P(X,U,7)=1),(PXDXI=1) S @ROOT@("PL ADD")=$P(X,U,7),PROBLEMS(ICD)=NARR_U_CODE
"RTN","PXRPC",85,0)
 . . . S:$L($P(X,U,10))>0&(PXDXI=1) COMMENT($P(X,U,10))="DX/PL^"_ICD
"RTN","PXRPC",86,0)
 . . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",87,0)
 . I $E(TYP,1,3)="IMM" D  Q
"RTN","PXRPC",88,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",89,0)
 . . S IMM=IMM+1,ROOT="PXAPI(""IMMUNIZATION"","_IMM_")"
"RTN","PXRPC",90,0)
 . . S @ROOT@("IMMUN")=CODE
"RTN","PXRPC",91,0)
 . . S:$L($P(X,U,5)) @ROOT@("SERIES")=$P(X,U,5)
"RTN","PXRPC",92,0)
 . . S:$L($P(X,U,7)) @ROOT@("REACTION")=$P(X,U,7)
"RTN","PXRPC",93,0)
 . . S:$L($P(X,U,8)) @ROOT@("CONTRAINDICATED")=$P(X,U,8)
"RTN","PXRPC",94,0)
 . . S:$L($P(X,U,9)) @ROOT@("REFUSED")=$P(X,U,9)
"RTN","PXRPC",95,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",96,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="IMMUNIZATION^"_IMM
"RTN","PXRPC",97,0)
 . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",98,0)
 . I $E(TYP,1,2)="SK" D  Q
"RTN","PXRPC",99,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",100,0)
 . . S SK=SK+1,ROOT="PXAPI(""SKIN TEST"","_SK_")"
"RTN","PXRPC",101,0)
 . . S @ROOT@("TEST")=CODE
"RTN","PXRPC",102,0)
 . . S:$L($P(X,U,5)) @ROOT@("RESULT")=$P(X,U,5)
"RTN","PXRPC",103,0)
 . . S:$L($P(X,U,7)) @ROOT@("READING")=$P(X,U,7)
"RTN","PXRPC",104,0)
 . . S:$L($P(X,U,8)) @ROOT@("D/T READ")=$P(X,U,8)
"RTN","PXRPC",105,0)
 . . S:$L($P(X,U,9)) @ROOT@("EVENT D/T")=$P(X,U,9)
"RTN","PXRPC",106,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",107,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="SKIN TEST^"_SK
"RTN","PXRPC",108,0)
 . . I $E(TYP,3)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",109,0)
 . I $E(TYP,1,3)="PED" D  Q
"RTN","PXRPC",110,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",111,0)
 . . S PED=PED+1,ROOT="PXAPI(""PATIENT ED"","_PED_")"
"RTN","PXRPC",112,0)
 . . S @ROOT@("TOPIC")=CODE
"RTN","PXRPC",113,0)
 . . S:$L($P(X,U,5)) @ROOT@("UNDERSTANDING")=$P(X,U,5)
"RTN","PXRPC",114,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",115,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="PATIENT ED^"_PED
"RTN","PXRPC",116,0)
 . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",117,0)
 . I $E(TYP,1,2)="HF" D  Q
"RTN","PXRPC",118,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",119,0)
 . . S HF=HF+1,ROOT="PXAPI(""HEALTH FACTOR"","_HF_")"
"RTN","PXRPC",120,0)
 . . S @ROOT@("HEALTH FACTOR")=CODE
"RTN","PXRPC",121,0)
 . . S:$L($P(X,U,5)) @ROOT@("LEVEL/SEVERITY")=$P(X,U,5)
"RTN","PXRPC",122,0)
 . . S:$P(X,U,6)'>0 $P(X,U,6)=$G(PXAPI("PROVIDER",1,"NAME"))
"RTN","PXRPC",123,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",124,0)
 . . S:$L($P(X,U,11)) @ROOT@("EVENT D/T")=$P($P(X,U,11),";",1)
"RTN","PXRPC",125,0)
 . . S:$L($P(X,U,11)) SRC=$P($P(X,U,11),";",2)
"RTN","PXRPC",126,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="HEALTH FACTOR^"_HF
"RTN","PXRPC",127,0)
 . . I $E(TYP,3)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",128,0)
 . I $E(TYP,1,3)="XAM" D  Q
"RTN","PXRPC",129,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",130,0)
 . . S XAM=XAM+1,ROOT="PXAPI(""EXAM"","_XAM_")"
"RTN","PXRPC",131,0)
 . . S @ROOT@("EXAM")=CODE
"RTN","PXRPC",132,0)
 . . S:$L($P(X,U,5)) @ROOT@("RESULT")=$P(X,U,5)
"RTN","PXRPC",133,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",134,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="EXAM^"_XAM
"RTN","PXRPC",135,0)
 . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1
"RTN","PXRPC",136,0)
 . I $E(TYP,1,3)="TRT" D  Q
"RTN","PXRPC",137,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",138,0)
 . . S TRT=TRT+1,ROOT="PXAPI(""TREATMENT"","_TRT_")"
"RTN","PXRPC",139,0)
 . . S @ROOT@("IMMUN")=CODE
"RTN","PXRPC",140,0)
 . . S:$L(CAT) @ROOT@("CATEGORY")=CAT
"RTN","PXRPC",141,0)
 . . S:$L(NARR) @ROOT@("NARRATIVE")=NARR
"RTN","PXRPC",142,0)
 . . S:$L($P(X,U,5)) @ROOT@("QTY")=$P(X,U,5)
"RTN","PXRPC",143,0)
 . . S:$P(X,U,6)>0 @ROOT@("ENC PROVIDER")=$P(X,U,6)
"RTN","PXRPC",144,0)
 . . S:$L($P(X,U,10))>0 COMMENT($P(X,U,10))="TREATMENT^"_TRT
"RTN","PXRPC",145,0)
 . . I $E(TYP,4)="-" S @ROOT@("DELETE")=1,@ROOT@("QTY")=0
"RTN","PXRPC",146,0)
 . I $E(TYP,1,3)="COM" D  Q
"RTN","PXRPC",147,0)
 . . Q:'$L(CODE)
"RTN","PXRPC",148,0)
 . . Q:'$L(CAT)
"RTN","PXRPC",149,0)
 . . S COMMENTS(CODE)=$P(X,U,3,999)
"RTN","PXRPC",150,0)
 ;Store the comments
"RTN","PXRPC",151,0)
 S COM=""
"RTN","PXRPC",152,0)
 F  S COM=$O(COMMENT(COM)) Q:COM=""  S:$D(COMMENTS(COM)) PXAPI($P(COMMENT(COM),"^",1),$P(COMMENT(COM),"^",2),"COMMENT")=COMMENTS(COM)
"RTN","PXRPC",153,0)
 ;
"RTN","PXRPC",154,0)
 S PXAPI("ENCOUNTER",1,"ENCOUNTER TYPE")="P"
"RTN","PXRPC",155,0)
DATA2PCE ; 
"RTN","PXRPC",156,0)
 I '$D(PXAPI)#10 S OK=-3 Q
"RTN","PXRPC",157,0)
 I '($D(PXAVST)#2) S PXAVST=""
"RTN","PXRPC",158,0)
 S OK=$$DATA2PCE^PXAI("PXAPI",PKG,SRC,.PXAVST,"","",.ERROR,"","","")
"RTN","PXRPC",159,0)
 Q
"VER")
8.0^22.0
"BLD",9117,6)
^154
**END**
**END**

